<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Notes About Using Advanced Search In PDMShell | SOLIDWORKS PDM | Powershell like features for SOLIDWORKS PDM Professional </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Notes About Using Advanced Search In PDMShell | SOLIDWORKS PDM | Powershell like features for SOLIDWORKS PDM Professional ">
      
      <meta name="description" content="Learn how to run PDMShell advanced search">
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/BlueByteSystemsInc/PDMShell.Docs/blob/master/src/advancedsearch.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/fav.png" alt="PDMShell">
            PDMShell
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="pdmshell-advanced-search-guide">PDMShell Advanced Search Guide</h1>

<p>PDMShell provides a complete search engine based on PDM's own search. This feature is extremely useful with commands that have a <code>-search</code> parameter.</p>
<p>This guide explains how the <code>-search</code> parameter works, how to use tokens, variables, operators, and how PDMShell parses and applies search rules.</p>
<h1 id="wildcards-in-pdmshell-sql-style-pattern-matching">Wildcards in PDMShell (SQL-Style Pattern Matching)</h1>
<p>PDMShell supports the same wildcard patterns used in SOLIDWORKS PDM and standard SQL-like matching rules. These allow you to control how filenames are matched inside any <code>-search</code> query.</p>
<table>
<thead>
<tr>
<th>Wildcard</th>
<th>Meaning</th>
<th>Example</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>%</code></td>
<td>Matches <strong>zero or more characters</strong></td>
<td><code>%.sldprt</code></td>
<td>Returns all part files</td>
</tr>
<tr>
<td><code>_</code></td>
<td>Matches <strong>exactly one character</strong></td>
<td><code>pump_.sldprt</code></td>
<td>Matches <code>pump1.sldprt</code>, <code>pumpA.sldprt</code>, <strong>not</strong> <code>pump10.sldprt</code></td>
</tr>
</tbody>
</table>
<h2 id="1-overview">1. Overview</h2>
<p>The <code>-search</code> parameter accepts simple text queries or advanced multi-condition expressions that filter files and folders using PDM system tokens and variable values.</p>
<h2 id="2-simple-searches">2. Simple Searches</h2>
<p>If no operators are present, the entire input is treated as a Name filter.</p>
<p>Examples:</p>
<pre><code class="lang-bash">pump.sldprt     # Searches for files explicitly named pump.sldprt
assembly_1001   # Searches for any file whose name contains 'assembly_1001'
%.sldasm        # Searches for all SOLIDWORKS assembly files in the current folder

</code></pre>
<p>Equivalent to:</p>
<pre><code class="lang-bash">Name=pump.sldprt
Name=passembly_1001
Name=%.sldasm  
</code></pre>
<h2 id="3-advanced-syntax">3. Advanced Syntax</h2>
<p>Multiple conditions are separated using semicolons.</p>
<p>Example:</p>
<pre><code class="lang-bash">Name=%Pump%;Recursive=true;VersionsBefore=20200101   # Finds files with 'Pump' in the name, searches subfolders, and only returns versions created before Jan 1st 2020
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Dates must follow the <code>yyyMMdd</code> format.</p>
</div>
<p>Escaping rules:</p>
<pre><code class="lang-bash">\; inserts a semicolon  
\= inserts an equals sign  
\\ inserts a literal backslash
</code></pre>
<p>Example:</p>
<pre><code class="lang-bash">Name=Valve\=A;Label=Released\;Approved   # Searches for files literally named &quot;Valve=A&quot; and having a label containing the text &quot;Released;Approved&quot;
</code></pre>
<h2 id="4-built-in-search-tokens">4. Built-in Search Tokens</h2>
<p>These tokens map directly to EdmSearchToken values and control how PDMShell filters PDM objects.</p>
<h3 id="table-supported-search-tokens">Table: Supported Search Tokens</h3>
<table>
<thead>
<tr>
<th>Token</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>File or folder name filter</td>
</tr>
<tr>
<td>AllVersions</td>
<td>Search all versions</td>
</tr>
<tr>
<td>ContentText</td>
<td>Full-text content search string</td>
</tr>
<tr>
<td>ContentTextExact</td>
<td>Exact match of content</td>
</tr>
<tr>
<td>ContentTextInBody</td>
<td>Search inside file body</td>
</tr>
<tr>
<td>ContentTextInProperties</td>
<td>Search in custom properties</td>
</tr>
<tr>
<td>ContentTextOr</td>
<td>Match any word</td>
</tr>
<tr>
<td>FindFiles</td>
<td>Include files in results</td>
</tr>
<tr>
<td>FindFolders</td>
<td>Include folders in results</td>
</tr>
<tr>
<td>FindItems</td>
<td>Include items in results</td>
</tr>
<tr>
<td>FolderID</td>
<td>Starting folder ID</td>
</tr>
<tr>
<td>HistoryAfter</td>
<td>Search history after date</td>
</tr>
<tr>
<td>HistoryBefore</td>
<td>Search history before date</td>
</tr>
<tr>
<td>HistoryString</td>
<td>History string search</td>
</tr>
<tr>
<td>HistoryStringConfiguration</td>
<td>Search configuration names</td>
</tr>
<tr>
<td>HistoryStringFileName</td>
<td>Search file names in history</td>
</tr>
<tr>
<td>HistoryStringLabels</td>
<td>Search labels in history</td>
</tr>
<tr>
<td>HistoryStringRevisionComment</td>
<td>Search revision comments</td>
</tr>
<tr>
<td>HistoryStringStateComment</td>
<td>Search state change comments</td>
</tr>
<tr>
<td>HistoryStringVariableValues</td>
<td>Search variable changes</td>
</tr>
<tr>
<td>HistoryStringVersionComment</td>
<td>Search version comments</td>
</tr>
<tr>
<td>Label</td>
<td>Search label text</td>
</tr>
<tr>
<td>LabelAfter</td>
<td>Labels after date</td>
</tr>
<tr>
<td>LabelBefore</td>
<td>Labels before date</td>
</tr>
<tr>
<td>LabelByUser</td>
<td>Labels created by user</td>
</tr>
<tr>
<td>LabelComment</td>
<td>Search label comment</td>
</tr>
<tr>
<td>Locked</td>
<td>Return checked-out files</td>
</tr>
<tr>
<td>LockedBy</td>
<td>Return files locked by user</td>
</tr>
<tr>
<td>Recursive</td>
<td>Include subfolders</td>
</tr>
<tr>
<td>StateAfter</td>
<td>State changes after date</td>
</tr>
<tr>
<td>StateBefore</td>
<td>State changes before date</td>
</tr>
<tr>
<td>StateByUser</td>
<td>User who changed state</td>
</tr>
<tr>
<td>StateHistoric</td>
<td>Search historic states</td>
</tr>
<tr>
<td>StateID</td>
<td>Workflow state ID</td>
</tr>
<tr>
<td>StateName</td>
<td>Workflow state name</td>
</tr>
<tr>
<td>Unlocked</td>
<td>Return checked-in files</td>
</tr>
<tr>
<td>VersionComment</td>
<td>Search version comment</td>
</tr>
<tr>
<td>VersionsAfter</td>
<td>Versions after date</td>
</tr>
<tr>
<td>VersionsBefore</td>
<td>Versions before date</td>
</tr>
<tr>
<td>VersionsByUser</td>
<td>Versions created by user</td>
</tr>
<tr>
<td>WorkflowName</td>
<td>Search by workflow name</td>
</tr>
<tr>
<td><strong>DuplicatedBy</strong></td>
<td><strong>Finds duplicates either by name, variables, hash and filedate</strong></td>
</tr>
</tbody>
</table>
<h4 id="duplicates">Duplicates</h4>
<p>You can use <code>DuplicatedBy</code> to list the items either filename, variable, ash or last date the file was modified. To use the hash, files must be locally cached.</p>
<pre><code class="lang-bash"># finds all solidworks duplicate solidworks files by name and list their file date, hash and revision variable
search -search &quot;Name=%.sld%;Recursive=true;DuplicatedBy=Name&quot; -columns &quot;FileDate,Hash,Revision&quot;
</code></pre>
<pre><code class="lang-bash"># finds all solidworks duplicate solidworks files by revision and list their file date, hash and revision variable
search -search &quot;Name=%.sld%;Recursive=true;DuplicatedBy=@Revision&quot; -columns &quot;FileDate,Hash,Revision&quot;
</code></pre>
<h2 id="5-default-behavior">5. Default Behavior</h2>
<p><code>FolderID</code> defaults to the active directory.<br>
<code>Recursive</code> defaults to the global flag.<br>
<code>FindFolders</code> defaults to the includefolders flag.<br>
<code>FindFiles</code> is always true.</p>
<h2 id="6-variable-search">6. Variable Search</h2>
<p>Conditions beginning with @ use PDM variables.</p>
<p>Format:</p>
<pre><code class="lang-bash">@VariableName Operator Value
</code></pre>
<p>Examples:</p>
<pre><code class="lang-bash">@Description=Pump      # Variable 'Description' must equal &quot;Pump&quot;
@Weight&gt;=10            # Numeric variable 'Weight' must be greater than or equal to 10
@Revision!=A           # Variable 'Revision' must NOT be &quot;A&quot;
@Material~Steel        # Variable 'Material' must contain the text &quot;Steel&quot;
@ProjectCode!~TEST     # Variable 'ProjectCode' must NOT contain the text &quot;TEST&quot;
</code></pre>
<p>PDMShell automatically:</p>
<ol>
<li>Detects the operator</li>
<li>Extracts variable name and value</li>
<li>Looks up the variable definition using IEdmVariable5</li>
<li>Determines the variable type</li>
<li>Converts the value to the correct type</li>
<li>Selects the appropriate EdmVarOp_* enum</li>
<li>Applies AddVariable2</li>
</ol>
<h2 id="7-supported-variable-operators">7. Supported Variable Operators</h2>
<p>PDMShell supports all major comparison operators for variables.</p>
<h3 id="table-supported-operators">Table: Supported Operators</h3>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>Equal</td>
</tr>
<tr>
<td>!=</td>
<td>Not equal</td>
</tr>
<tr>
<td>&lt;&gt;</td>
<td>Not equal</td>
</tr>
<tr>
<td>&gt;</td>
<td>Greater than</td>
</tr>
<tr>
<td>&lt;</td>
<td>Less than</td>
</tr>
<tr>
<td>&gt;=</td>
<td>Greater or equal</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Less or equal</td>
</tr>
<tr>
<td>~</td>
<td>Contains</td>
</tr>
<tr>
<td>!~</td>
<td>Does not contain</td>
</tr>
</tbody>
</table>
<h2 id="8-variable-operator-to-enum-mapping">8. Variable Operator-to-Enum Mapping</h2>
<h3 id="table-string-variable-operator-mapping">Table: String Variable Operator Mapping</h3>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Enum</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>Equals</td>
</tr>
<tr>
<td>!= / &lt;&gt;</td>
<td>Different</td>
</tr>
<tr>
<td>&gt;</td>
<td>Greater</td>
</tr>
<tr>
<td>&lt;</td>
<td>Less</td>
</tr>
<tr>
<td>&gt;=</td>
<td>Greater or equal</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Less or equal</td>
</tr>
<tr>
<td>~</td>
<td>Contains</td>
</tr>
<tr>
<td>!~</td>
<td>Not contains</td>
</tr>
</tbody>
</table>
<h3 id="numeric-and-date-types-use-the-corresponding-numericdate-enum-sets">Numeric and date types use the corresponding numeric/date enum sets.</h3>
<p>Dates must be in the format: yyyyMMdd</p>
<h2 id="9-operator-detection">9. Operator Detection</h2>
<p>Operators are detected longest-first to avoid ambiguity.</p>
<h3 id="table-operator-detection-order">Table: Operator Detection Order</h3>
<table>
<thead>
<tr>
<th>Order</th>
<th>Operator</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>&gt;=</td>
</tr>
<tr>
<td>2</td>
<td>&lt;=</td>
</tr>
<tr>
<td>3</td>
<td>!=</td>
</tr>
<tr>
<td>4</td>
<td>&lt;&gt;</td>
</tr>
<tr>
<td>5</td>
<td>!~</td>
</tr>
<tr>
<td>6</td>
<td>~</td>
</tr>
<tr>
<td>7</td>
<td>&gt;</td>
</tr>
<tr>
<td>8</td>
<td>&lt;</td>
</tr>
<tr>
<td>9</td>
<td>=</td>
</tr>
</tbody>
</table>
<p>This ensures &gt;= is not incorrectly parsed as &gt;.</p>
<h2 id="10-combining-tokens-and-variables">10. Combining Tokens and Variables</h2>
<p>Tokens and variable conditions can be mixed:</p>
<pre><code class="lang-bash">Name=%Pump%;@Description~Steel;StateName=Released;@Weight&gt;=5   # Files with names containing 'Pump', description containing 'Steel', state equal to Released, and weight &gt;= 5
</code></pre>
<p>All conditions must match.</p>
<h2 id="11-invalid-input-handling">11. Invalid Input Handling</h2>
<p>Invalid expressions are ignored silently. PDMShell continues applying valid conditions.</p>
<p>Examples ignored:</p>
<pre><code class="lang-bash">@MissingVar=Test  
HistoryBefore=BADDATE  
UnknownKey=Value  
</code></pre>
<h2 id="12-examples">12. Examples</h2>
<p>Search by name:</p>
<pre><code class="lang-bash">Name=%Valve%
# Finds all files whose name contains 'Valve'
</code></pre>
<p>Search by folder:</p>
<pre><code class="lang-bash">Name=%Valve%;FolderID=102          
# Same search, but restricted to folder with ID 102
</code></pre>
<p>Variable contains:</p>
<pre><code class="lang-bash">@Description~Pump                
# Matches files where Description contains the text 'Pump'
</code></pre>
<p>Token and variable together:</p>
<pre><code class="lang-bash">StateName=Approved;@Revision!=A  
# Files in state 'Approved' AND Revision variable not equal to 'A'
</code></pre>
<p>More complex:</p>
<pre><code class="lang-bash">Name=%Pump%;@Material~Steel;@Weight&gt;=15;Recursive=true;VersionsBefore=20200101
# Files with 'Pump' in the name, Material containing 'Steel', Weight &gt;= 15,
# include subfolders, and versions created before Jan 1st 2020
</code></pre>
<h2 id="13-technical-support">13. Technical support</h2>
<p>Please reach out to us if you have a premium license or considering getting one from our contact <a href="https://bluebyte.biz/contact">page</a> on our main website.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/BlueByteSystemsInc/PDMShell.Docs/blob/master/src/advancedsearch.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span><a href='https://pdmshell.com'>Blue Byte Systems Inc</a>. Made with Maple syrup üçÅ and Couscous üç≤.</span>
        </div>
      </div>
    </footer>
  </body>
</html>
